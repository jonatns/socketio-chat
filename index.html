<!doctype html>
<html>
  <head>
    <title>Socket.IO chat</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/skeleton.css">
    <link rel="stylesheet" href="css/style.css">
  </head>

  <body>

      <div class="message-container">
          <div class="container">
            <div class="row">
              <div class="twelve columns">
                <table id="messages" class="u-full-width">
                </table>
              </div>
            </div>
          </div>
      </div>

        <div class="footer-container">
          <div class="container">
            <footer id="footer" class="twelve columns">
              <form>
                <div class="row">
                  <div class="two columns">
                    <input class="u-full-width" type="text" id="nickname" placeholder="nickname">
                  </div>
                  <div class="eight columns">
                    <input class="u-full-width" type="text" id="message" placeholder="message">
                  </div>
                  <div class="two columns">
                    <button id="submit" class="button-primary" disabled="disabled">Send</button>
                  </div>
                </div>
              </form>
            </footer>
          </div>
        </div>

  </body>

  <script src="/socket.io/socket.io.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
  <script>
    var socket = io();

    $(document).ready(function() {
      $('#submit').attr('disabled', true);

      $('#message').keyup(function(){
        $('#submit').prop('disabled', this.value.length === 0 ? true : false);
      });

      $('form').submit(function(event) {
        socket.emit('chat message', $('#message').val());
        $('#messages').append($('<tr style="background-color: #F5F5F5;"><td style="text-align: right; padding-right: 10px;">' + 'me: ' + $('#message').val() + '</td></tr>'));
        $('#message').val('');
        $('#submit').attr('disabled', true);
        event.preventDefault();
      });

      $('#nickname').change(function(event) {
        socket.emit('nickname', $('#nickname').val());
        event.preventDefault();
      });

      socket.on('chat message', function(msg){
        $('#messages').append($('<tr><td>' + msg + '</td></tr>'));
      });

    });

  </script>
</html>
